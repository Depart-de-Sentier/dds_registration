{"version":3,"sources":["src/assets/stripe-init/stripe_payment_intents_support.ts","src/assets/stripe-init/billing_event_stripe_payment_proceed.ts","src/assets/stripe-init/billing_membership_stripe_payment_proceed.ts","src/assets/scripts.ts","src/assets/test/test.ts"],"names":[],"mappings":"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","file":"scripts.js","sourcesContent":["/**\n * @module stripe_payment_intents_support.ts\n * @changed 2024.04.04, 00:21\n */\n\nimport type {\n  Stripe,\n  StripeElements,\n  StripeElementsOptionsClientSecret,\n  StripeError,\n  StripePaymentElement,\n} from '@stripe/stripe-js/dist/stripe-js';\n\n/** Form action */\nfunction submitStripeForm(stripe: Stripe, params: TCreateCheckoutSessionParams, elements: StripeElements, event: SubmitEvent) {\n  const {\n    success_url,\n  } = params;\n\n  event.preventDefault();\n\n  // @see https://docs.stripe.com/payments/accept-a-payment?platform=web&ui=elements#web-submit-payment\n  // const result = await\n  stripe.confirmPayment({\n    elements,\n    confirmParams: {\n      return_url: success_url,\n    },\n  }).then((result) => {\n    const error: StripeError = result.error;\n\n    if (error) {\n      // debugger;\n      console.error('[billing_event_stripe_payment_proceed:startStripeElementsForm:submitStripeForm] error', {\n        error,\n        event,\n        params,\n        stripe,\n      });\n\n      // Show error\n      const messageContainer = document.querySelector('#error-message');\n      if (messageContainer) {\n        messageContainer.textContent = error.message || '';\n      }\n    } else {\n      // Success: redirect to success message\n      console.log('[billing_event_stripe_payment_proceed:startStripeElementsForm:submitStripeForm] success', {\n        success_url,\n        event,\n        params,\n        stripe,\n      });\n      debugger;\n      window.location.href = success_url;\n    }\n  }).catch((error) => {\n      console.error('[billing_event_stripe_payment_proceed:startStripeElementsForm:submitStripeForm] error', {\n        error,\n        event,\n        params,\n        stripe,\n      });\n  });\n}\n\n/** Start stripe payment form */\nexport function startStripeElementsForm(params: TCreateCheckoutSessionParams) {\n  const {\n    STRIPE_PUBLISHABLE_KEY,\n    // success_url,\n    client_secret,\n  } = params;\n\n  // Initialize Stripe.js\n  const stripe: Stripe = window.Stripe(STRIPE_PUBLISHABLE_KEY);\n\n  // @see https://docs.stripe.com/js/elements_object/create_payment_element#payment_element_create-options\n  const options: StripeElementsOptionsClientSecret = {\n    clientSecret: client_secret,\n    // TODO: Customize forms (use bootstrap styles)...\n    // appearance: {},\n  };\n\n  // Set up Stripe.js and Elements to use in checkout form, passing the client secret obtained in a previous step\n  const elements: StripeElements = stripe.elements(options);\n\n  // Create and mount the Payment Element\n  // @see https://docs.stripe.com/js/elements_object/create_payment_element\n  const paymentElement: StripePaymentElement = elements.create('payment');\n  paymentElement.mount('#payment-element');\n\n  const form = document.getElementById('payment-form');\n\n  if (!form) {\n    const errorText = 'Form node could not be found!'\n    const error = new Error(errorText);\n    console.log('[billing_event_stripe_payment_proceed:startStripeElementsForm] error', errorText, {\n      error,\n      params,\n      stripe,\n      options,\n      elements,\n      paymentElement,\n      form,\n    });\n    debugger;\n    return;\n  }\n\n  form.addEventListener('submit', submitStripeForm.bind(null, stripe, params, elements));\n}\n","/**\n * @module billing_event_stripe_payment_proceed.ts\n * @changed 2024.04.04, 00:21\n */\n\nimport { startStripeElementsForm } from './stripe_payment_intents_support'\n\nexport const billing_event_stripe_payment_proceed = startStripeElementsForm;\n// NOTE: It's possible to use `startStripeElementsForm` directly here.\n\n","/**\n * @module billing_membership_stripe_payment_proceed.ts\n * @changed 2024.04.04, 01:15\n */\n\nimport { startStripeElementsForm } from './stripe_payment_intents_support'\n\nexport const billing_membership_stripe_payment_proceed = startStripeElementsForm;\n// NOTE: It's possible to use `startStripeElementsForm` directly here.\n","/**\n * @desc Main js entry point module (scripts)\n * @module src/assets/scripts.ts\n * @changed 2024.04.03, 20:03\n */\n\nimport { billing_event_stripe_payment_proceed } from './stripe-init/billing_event_stripe_payment_proceed';\nimport { billing_membership_stripe_payment_proceed } from './stripe-init/billing_membership_stripe_payment_proceed';\n\n// Expose functions to global scope...\nwindow.billing_event_stripe_payment_proceed = billing_event_stripe_payment_proceed;\nwindow.billing_membership_stripe_payment_proceed = billing_membership_stripe_payment_proceed;\n\nconsole.log('[scripts] Main client code entry point', {\n  billing_event_stripe_payment_proceed,\n  billing_membership_stripe_payment_proceed,\n});\n","/**\n * @module test.ts\n * @changed 2024.04.03, 16:18\n */\n\n(function (window) {\n  // console.log('Test', window);\n})(window);\n"]}
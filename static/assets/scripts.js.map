{"version":3,"sources":["src/assets/stripe-init/billing_event_stripe_payment_proceed.ts","src/assets/stripe-init/billing_membership_stripe_payment_proceed.ts","src/assets/scripts.ts","src/assets/test/test.ts"],"names":[],"mappings":"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","file":"scripts.js","sourcesContent":["/**\n * @module billing_event_stripe_payment_proceed.ts\n * @changed 2024.04.03, 23:01\n */\n\nimport type {\n  StripeElements,\n  StripeElementsOptionsClientSecret,\n  StripeError,\n  StripePaymentElement,\n} from '@stripe/stripe-js/dist/stripe-js';\n\nexport function billing_event_stripe_payment_proceed(params: TCreateCheckoutSessionParams) {\n  const {\n    // \\<\\(STRIPE_PUBLISHABLE_KEY\\|success_url\\|client_secret\\)\\>\n\n    STRIPE_PUBLISHABLE_KEY,\n    success_url,\n    client_secret,\n  } = params;\n\n  console.log('[billing_event_stripe_payment_proceed]', {\n    STRIPE_PUBLISHABLE_KEY,\n    client_secret,\n    success_url,\n  });\n\n  // Initialize Stripe.js\n  const stripe = window.Stripe(STRIPE_PUBLISHABLE_KEY);\n\n  startElements();\n\n  /** Start stripe payment form */\n  function startElements() {\n    // @see https://docs.stripe.com/js/elements_object/create_payment_element#payment_element_create-options\n    const options: StripeElementsOptionsClientSecret = {\n      clientSecret: client_secret,\n      // TODO: Customize forms (use bootstrap styles)...\n      // appearance: {},\n    };\n\n    // Set up Stripe.js and Elements to use in checkout form, passing the client secret obtained in a previous step\n    const elements: StripeElements = stripe.elements(options);\n\n    // Create and mount the Payment Element\n    // @see https://docs.stripe.com/js/elements_object/create_payment_element\n    const paymentElement: StripePaymentElement = elements.create('payment');\n    paymentElement.mount('#payment-element');\n\n    const form = document.getElementById('payment-form');\n\n    if (!form) {\n      const errorText = 'Form node could not be found!'\n      const error = new Error(errorText);\n      console.log('[billing_event_stripe_payment_proceed:startElements] error', errorText, {\n        error,\n        params,\n        stripe,\n        options,\n        elements,\n        paymentElement,\n        form,\n      });\n      debugger;\n      return;\n    }\n\n    form.addEventListener('submit', submitForm.bind(null, elements));\n  }\n\n  /** Form action */\n  function submitForm(elements: StripeElements, event: SubmitEvent) {\n    event.preventDefault();\n\n    // @see https://docs.stripe.com/payments/accept-a-payment?platform=web&ui=elements#web-submit-payment\n    // const result = await\n    stripe.confirmPayment({\n      elements,\n      confirmParams: {\n        return_url: success_url,\n      },\n    }).then((result) => {\n      const error: StripeError = result.error;\n\n      if (error) {\n        // debugger;\n        console.error('[billing_event_stripe_payment_proceed:startElements:submitForm] error', {\n          error,\n          event,\n          params,\n          stripe,\n        });\n\n        // Show error\n        const messageContainer = document.querySelector('#error-message');\n        if (messageContainer) {\n          messageContainer.textContent = error.message || '';\n        }\n      } else {\n        // Success: redirect to success message\n        console.log('[billing_event_stripe_payment_proceed:startElements:submitForm] success', {\n          success_url,\n          event,\n          params,\n          stripe,\n        });\n        debugger;\n        window.location.href = success_url;\n      }\n    }).catch((error) => {\n        console.error('[billing_event_stripe_payment_proceed:startElements:submitForm] error', {\n          error,\n          event,\n          params,\n          stripe,\n        });\n    });\n  }\n\n}\n","/**\n * @module billing_membership_stripe_payment_proceed.ts\n * @changed 2024.04.03, 16:18\n */\n\nexport function billing_membership_stripe_payment_proceed(params: TCreateCheckoutSessionParams) {\n  const {\n    STRIPE_PUBLISHABLE_KEY,\n    success_url,\n  } = params;\n\n  console.log('[billing_membership_stripe_payment_proceed]', {\n    STRIPE_PUBLISHABLE_KEY,\n    success_url,\n  });\n\n  // Initialize Stripe.js\n  const stripe = window.Stripe(STRIPE_PUBLISHABLE_KEY);\n\n  initialize();\n\n  // Fetch Checkout Session and retrieve the client secret\n  async function initialize() {\n    const fetchClientSecret = async () => {\n      const response = await fetch(success_url, {\n        method: 'POST',\n      });\n      const { clientSecret } = await response.json();\n      return clientSecret;\n    };\n\n    // Initialize Checkout\n    const checkout = await stripe.initEmbeddedCheckout({\n      fetchClientSecret,\n    });\n\n    // Mount Checkout\n    checkout.mount('#checkout');\n  }\n\n}\n","/**\n * @desc Main js entry point module (scripts)\n * @module src/assets/scripts.ts\n * @changed 2024.04.03, 20:03\n */\n\nimport { billing_event_stripe_payment_proceed } from './stripe-init/billing_event_stripe_payment_proceed';\nimport { billing_membership_stripe_payment_proceed } from './stripe-init/billing_membership_stripe_payment_proceed';\n\n// Expose functions to global scope...\nwindow.billing_event_stripe_payment_proceed = billing_event_stripe_payment_proceed;\nwindow.billing_membership_stripe_payment_proceed = billing_membership_stripe_payment_proceed;\n\nconsole.log('[scripts] Main client code entry point', {\n  billing_event_stripe_payment_proceed,\n  billing_membership_stripe_payment_proceed,\n});\n","/**\n * @module test.ts\n * @changed 2024.04.03, 16:18\n */\n\n(function (window) {\n  // console.log('Test', window);\n})(window);\n"]}